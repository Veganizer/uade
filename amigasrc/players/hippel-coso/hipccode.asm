;               T

lbC000026	MOVEQ	#0,D0
	MOVE.W	(lbW000C02,PC),D0
	RTS

hipc_setvol	PEA	(A0)
	LEA	(lbW000C00,PC),A0
	MOVE.W	D0,(A0)
	MOVE.L	(SP)+,A0
	RTS

hipc_init	MOVEM.L	D0-D7/A0-A6,-(SP)	;d0 = subsong (>=1)
	MOVE.W	D0,-(SP)	;a0 = modptr
	BSR.W	hipc_initpointers_78
	MOVE.W	(SP)+,D0
	BNE.W	hipc_init_nopause	;subsong = 0 => pause
	LEA	(hipc_pauseboolean,PC),A6
	ST	(A6)
	BRA.B	hipc_end_init

hipc_init_nopause	MOVE.L	(hipc_subsongtabptr,PC),A1
	SUBQ.L	#1,D0
	ADD.W	D0,D0
	MOVE.W	D0,D1
	ADD.W	D0,D0
	ADD.W	D1,D0	;d0 = 6*(subsong-1)
	ADD.W	D0,A1
	MOVE.W	(A1)+,D0
	MOVE.W	(A1)+,D1
	LEA	(lbW000A12,PC),A6
	MOVE.W	(A1),(A6)+
	MOVE.W	(A1)+,(A6)+
	BSR.W	InitSubSong_42E
hipc_end_init	MOVEM.L	(SP)+,D0-D7/A0-A6
	RTS

hipc_initpointers_78
	LEA	(hipc_modptr,PC),A2
	MOVE.L	A0,(A2)
	MOVE.L	(4,A0),A1
	ADD.L	A0,A1
	LEA	(lbL000BD4,PC),A2
	MOVE.L	A1,(A2)
	MOVE.L	(8,A0),A1
	ADD.L	A0,A1
	LEA	(lbL000BDC,PC),A2
	MOVE.L	A1,(A2)
	MOVE.L	(12,A0),A1
	ADD.L	A0,A1
	LEA	(lbL000BD0,PC),A2
	MOVE.L	A1,(A2)
	MOVE.L	($10,A0),A1
	ADD.L	A0,A1
	LEA	(lbL000BE4,PC),A2
	MOVE.L	A1,(A2)
	MOVE.L	($14,A0),A1
	ADD.L	A0,A1
	LEA	(hipc_subsongtabptr,PC),A2
	MOVE.L	A1,(A2)
	MOVE.L	($18,A0),A1
	ADD.L	A0,A1
	LEA	(lbL000BE8,PC),A2
	MOVE.L	A1,(A2)
	MOVE.L	($1C,A0),A1
	ADD.L	A0,A1
	LEA	(lbL000BF0,PC),A2
	MOVE.L	A1,(A2)
	RTS

hipc_int	MOVEM.L	D0-D7/A0-A6,-(SP)
	MOVEQ	#0,D7
	MOVE.W	(hipc_pauseboolean,PC),D0
	BEQ.B	hipc_playit
	MOVE.W	#15,($DFF096)	;audio dma off
	MOVE.L	D7,($DFF0A6)	;audxper to zero
	MOVE.L	D7,($DFF0B6)
	MOVE.L	D7,($DFF0C6)
	MOVE.L	D7,($DFF0D6)
	MOVEM.L	(SP)+,D0-D7/A0-A6
	RTS

hipc_playit	LEA	($DFF000),A6
	LEA	(lbW000BCE,PC),A5
	MOVE.W	D7,(A5)
	LEA	(hipc_chanstruct_A18,PC),A0
	BSR.W	lbC000538
	MOVE.L	D0,-(SP)
	LEA	(lbL000A6C,PC),A0
	BSR.W	lbC000538
	MOVE.L	D0,-(SP)
	LEA	(lbL000AC0,PC),A0
	BSR.W	lbC000538
	MOVE.L	D0,-(SP)
	MOVE.W	(lbW000C02,PC),D1
	BNE.B	lbC000142
	LEA	(lbL000B14,PC),A0
	BSR.W	lbC000538
	BRA.W	lbC000202

lbC000142	MOVE.L	(lbL000BE8,PC),-(SP)
	MOVE.L	(lbL000BF0,PC),-(SP)
	MOVE.L	(lbL000BD4,PC),-(SP)
	MOVE.L	(lbL000BDC,PC),-(SP)
	LEA	(lbL000BEC,PC),A0
	LEA	(lbL000BF4,PC),A1
	LEA	(lbL000BD8,PC),A2
	LEA	(lbL000BE0,PC),A3
	MOVE.L	(A0),-(A0)
	MOVE.L	(A1),-(A1)
	MOVE.L	(A2),-(A2)
	MOVE.L	(A3),-(A3)
	LEA	(lbL000B68,PC),A0
	BSR.W	lbC000538
	MOVE.W	($38,A0),A1
	ADD.L	($10,A0),A1
	CMP.B	#$E1,(A1)
	BNE.B	lbC0001EA
	LEA	(lbW000C02,PC),A0
	CLR.W	(A0)
	LEA	(lbL000B14,PC),A0
	LEA	(lbW0009F4,PC),A1
	MOVE.L	A1,($10,A0)
	MOVE.L	A1,($14,A0)
	MOVE.B	#1,($44,A0)
	MOVE.B	#1,($45,A0)
	SF	($46,A0)
	MOVE.W	D7,($38,A0)
	SF	($47,A0)
	SF	($48,A0)
	SF	($49,A0)
	SF	($32,A0)
	MOVE.B	D7,($40,A0)
	SF	($4A,A0)
	SF	($4B,A0)
	MOVE.B	#$64,($51,A0)
	ST	($4C,A0)
	SF	($4D,A0)
	SF	($4F,A0)
	MOVE.W	D7,($36,A0)
	MOVE.W	D7,($1C,A0)
	MOVE.W	#1,($34,A0)
	MOVE.L	A1,(12,A0)
lbC0001EA	LEA	(lbL000BDC,PC),A0
	LEA	(lbL000BD4,PC),A1
	LEA	(lbL000BF0,PC),A2
	LEA	(lbL000BE8,PC),A3
	MOVE.L	(SP)+,(A0)
	MOVE.L	(SP)+,(A1)
	MOVE.L	(SP)+,(A2)
	MOVE.L	(SP)+,(A3)
lbC000202	MOVE.L	D0,-(SP)
	MOVE.W	(A5),D7
	BEQ.W	lbC000278
	OR.W	#$8000,D7
	MOVE.L	(lbL000A24,PC),A0
	MOVE.W	(lbW000A4C,PC),D0
	MOVE.L	(lbL000A78,PC),A1
	MOVE.W	(lbW000AA0,PC),D1
	MOVE.L	(lbL000ACC,PC),A2
	MOVE.W	(lbW000AF4,PC),D2
	MOVE.W	(lbW000C02,PC),D3
	BNE.B	lbC000236
	MOVE.L	(lbL000B20,PC),A3
	MOVE.W	(lbW000B48,PC),D3
	BRA.B	lbC00023E

lbC000236	MOVE.L	(lbL000B74,PC),A3
	MOVE.W	(lbW000B9C,PC),D3
lbC00023E	MOVE.W	D7,($96,A6)
	BSR.W	WaitRasterLineEnd
	MOVE.L	(SP)+,($D6,A6)
	MOVE.L	(SP)+,($C6,A6)
	MOVE.L	(SP)+,($B6,A6)
	MOVE.L	(SP)+,($A6,A6)
	MOVE.L	A0,($A0,A6)
	MOVE.W	D0,($A4,A6)
	MOVE.L	A1,($B0,A6)
	MOVE.W	D1,($B4,A6)
	MOVE.L	A2,($C0,A6)
	MOVE.W	D2,($C4,A6)
	MOVE.L	A3,($D0,A6)
	MOVE.W	D3,($D4,A6)
	BRA.B	lbC000288

lbC000278	MOVE.L	(SP)+,($D6,A6)
	MOVE.L	(SP)+,($C6,A6)
	MOVE.L	(SP)+,($B6,A6)
	MOVE.L	(SP)+,($A6,A6)
lbC000288	LEA	(lbW000A12,PC),A0
	SUBQ.W	#1,(A0)+
	BNE.B	lbC0002B6
	MOVE.W	(A0),-(A0)
	MOVEQ	#0,D5
	MOVEQ	#6,D6
	LEA	(hipc_chanstruct_A18,PC),A0
	BSR.W	lbC0002CC
	LEA	(lbL000A6C,PC),A0
	BSR.W	lbC0002CC
	LEA	(lbL000AC0,PC),A0
	BSR.W	lbC0002CC
	LEA	(lbL000B14,PC),A0
	BSR.W	lbC0002CC
lbC0002B6	MOVEM.L	(SP)+,D0-D7/A0-A6
lbC0002BA	RTS

WaitRasterLineEnd	MOVE.W	D0,-(SP)
	MOVE.B	(6,A6),D0
RasterLineLoop	CMP.B	(6,A6),D0
	BEQ.B	RasterLineLoop
	MOVE.W	(SP)+,D0
	RTS

lbC0002CC	SUBQ.B	#1,($3C,A0)
	BPL.B	lbC0002BA
	MOVE.B	($3D,A0),($3C,A0)
lbC0002D8	MOVE.L	($18,A0),A1
lbC0002DC	MOVE.B	(A1)+,D0
	CMP.B	#$FF,D0
	BNE.W	lbC00036C
	MOVE.L	(8,A0),A3
	MOVE.L	(4,A0),A2
	ADD.W	($3A,A0),A2
	CMP.L	A3,A2
	BNE.B	lbC0002FE
	MOVE.W	D5,($3A,A0)
	MOVE.L	(4,A0),A2

	jsr	SongEndFunc		* report song end

lbC0002FE	MOVEQ	#0,D1
	MOVEQ	#0,D2
	MOVE.B	(A2)+,D1
	MOVE.B	(A2)+,($4E,A0)
	MOVE.B	(A2),D2
	CMP.W	#$7F,D2
	BLE.B	lbC00034C
	MOVE.B	D2,D3
	LSR.W	#4,D3
	AND.W	#15,D3
	AND.W	#15,D2
	CMP.B	#15,D3
	BNE.B	lbC00033C
	MOVEQ	#$64,D3
	TST.W	D2
	BEQ.B	lbC000336
	MOVEQ	#15,D3
	SUB.W	D2,D3
	ADDQ.W	#1,D3
	ADD.W	D3,D3
	MOVE.W	D3,D2
	ADD.W	D3,D3
	ADD.W	D2,D3
lbC000336	MOVE.B	D3,($51,A0)
	BRA.B	lbC000350

lbC00033C	CMP.B	#8,D3
	BNE.B	lbC00034A
	LEA	(hipc_pauseboolean,PC),A2
	ST	(A2)
	BRA.B	lbC000350

lbC00034A	BRA.B	lbC000350

lbC00034C	MOVE.B	D2,($43,A0)
lbC000350	ADD.W	D1,D1
	MOVE.L	(lbL000BD0,PC),A3
	ADD.W	D1,A3
	MOVE.W	(A3),A3
	ADD.L	(hipc_modptr,PC),A3
	MOVE.L	A3,($18,A0)
	ADD.W	#12,($3A,A0)
	BRA.W	lbC0002D8

lbC00036C	CMP.B	#$FE,D0
	BNE.B	lbC00037E
	MOVE.B	(A1),($3D,A0)
	MOVE.B	(A1)+,($3C,A0)
	BRA.W	lbC0002DC

lbC00037E	CMP.B	#$FD,D0
	BNE.B	lbC000392
	MOVE.B	(A1),($3D,A0)
	MOVE.B	(A1)+,($3C,A0)
	MOVE.L	A1,($18,A0)
	RTS

lbC000392	MOVE.B	D0,($41,A0)
	MOVE.B	(A1)+,D1
	MOVE.B	D1,($42,A0)
	AND.W	#$E0,D1
	BEQ.B	lbC0003A6
	MOVE.B	(A1)+,($4B,A0)
lbC0003A6	MOVE.L	A1,($18,A0)
	MOVE.W	D5,($1C,A0)
	TST.B	D0
	BMI.W	lbC00042C
	MOVE.B	($42,A0),D1
	AND.W	#$1F,D1
	ADD.B	($43,A0),D1
	MOVE.L	(lbL000BDC,PC),A2
	ADD.W	D1,D1
	ADD.W	D1,A2
	MOVE.W	(A2),A2
	ADD.L	(hipc_modptr,PC),A2
	MOVE.W	D5,($38,A0)
	MOVE.B	(A2),($44,A0)
	MOVE.B	(A2)+,($45,A0)
	MOVEQ	#0,D1
	MOVE.B	(A2)+,D1
	MOVE.B	(A2)+,($48,A0)
	MOVEQ	#0,D0
	MOVE.B	#$40,($50,A0)
	MOVE.B	(A2)+,D0
	MOVE.B	D0,($49,A0)
	MOVE.B	D0,($40,A0)
	MOVE.B	(A2)+,($4A,A0)
	MOVE.L	A2,($10,A0)
	MOVE.B	D5,($46,A0)
	CMP.B	#$80,D1
	BEQ.B	lbC00042C
	MOVE.L	(lbL000BD4,PC),A2
	BTST	#6,($42,A0)
	BEQ.B	lbC000416
	MOVE.B	($4B,A0),D1
lbC000416	ADD.W	D1,D1
	ADD.W	D1,A2
	MOVE.W	(A2),A2
	ADD.L	(hipc_modptr,PC),A2
	MOVE.L	A2,($14,A0)
	MOVE.W	D5,($36,A0)
	MOVE.B	D5,($47,A0)
lbC00042C	RTS

InitSubSong_42E	MOVEQ	#0,D5
	LEA	($DFF000),A6
	MOVE.W	#15,($96,A6)	;audio dma off
	MOVE.W	#$780,($9A,A6)	;audio ints off
	MOVE.L	D0,D7
	MULU	#12,D7	;d7 = 12 * d0
	MOVE.L	D1,D6
	ADDQ.L	#1,D6
	MULU	#12,D6	;d6 = 12 * (d1 + 1)
	MOVEQ	#3,D0	;dbf loop counter
	LEA	(hipc_chanstruct_A18,PC),A0
	LEA	(lbW0009F4,PC),A1
	LEA	(hipc_chanoffsets,PC),A2
	LEA	(ZeroSample_A0C,PC),A5
ChanInitLoop_462	SF	($52,A0)
	MOVE.L	A1,($10,A0)
	MOVE.L	A1,($14,A0)
	MOVE.B	#1,($44,A0)
	MOVE.B	#1,($45,A0)
	SF	($46,A0)
	MOVE.W	D5,($38,A0)	;0
	SF	($47,A0)
	SF	($48,A0)
	SF	($49,A0)
	SF	($32,A0)
	MOVE.B	D5,($40,A0)	;0
	SF	($4A,A0)
	SF	($4B,A0)
	MOVE.B	#$64,($51,A0)
	ST	($4C,A0)
	ST	($3C,A0)
	SF	($4D,A0)
	SF	($4F,A0)
	MOVE.W	D5,($36,A0)	;0
	MOVE.W	D5,($1C,A0)
	MOVE.W	D5,($34,A0)
	MOVE.W	(A2)+,D1
	MOVE.W	(A2)+,D3
	DIVU	#3,D3
	MOVEQ	#0,D4
	BSET	D3,D4
	MOVE.W	D4,($3E,A0)
	MULU	#3,D3
	AND.L	#$FF,D3
	AND.L	#$FF,D1
	ADD.L	A6,D1
	MOVE.L	D1,A4
	MOVE.L	A5,(A4)+	;audxptr = zerosample
	MOVE.W	#1,(A4)+	;audxlen = 1
	MOVE.W	D5,(A4)+	;audxper = 0
	MOVE.W	D5,(A4)+	;audxvol = 0
	MOVE.L	D1,(0,A0)
	LEA	(lbW000536,PC),A3
	MOVE.L	A3,($18,A0)
	MOVE.L	(lbL000BE4,PC),(4,A0)
	MOVE.L	(lbL000BE4,PC),(8,A0)
	ADD.L	D6,(8,A0)
	ADD.L	D3,(8,A0)
	ADD.L	D7,(4,A0)
	ADD.L	D3,(4,A0)
	MOVE.W	D5,($3A,A0)
	LEA	($54,A0),A0
	DBRA	D0,ChanInitLoop_462
	LEA	(lbW000A12,PC),A0
	MOVE.W	#1,(A0)
	MOVE.W	D5,(4,A0)	;pause = 0
	LEA	(lbW000C02,PC),A0
	CLR.W	(A0)
	RTS

lbW000536	dc.w	$FFFF

lbC000538	TST.B	($47,A0)
	BEQ.B	lbC000546
	SUBQ.B	#1,($47,A0)
	BRA.W	lbC000822

lbC000546	MOVE.L	($14,A0),A1
	ADD.W	($36,A0),A1
lbC00054E	MOVEQ	#0,D0
	MOVE.B	(A1)+,D0
	CMP.W	#$E0,D0
	BLT.W	lbC00081A
	SUB.W	#$E0,D0
	jsr	check_table_jump	* error check, can be removed;)
	ADD.W	D0,D0
	MOVE.W	(JumpTable_568,PC,D0.W),D0
	JMP	(JumpTableBase_57C,PC,D0.W)

JumpTable_568	dc.w	lbC000594-JumpTableBase_57C
	dc.w	lbC000822-JumpTableBase_57C
	dc.w	lbC00076E-JumpTableBase_57C
	dc.w	lbC000586-JumpTableBase_57C
	dc.w	lbC0007D6-JumpTableBase_57C
	dc.w	lbC0006B0-JumpTableBase_57C
	dc.w	lbC000742-JumpTableBase_57C
	dc.w	lbC0005A4-JumpTableBase_57C
	dc.w	JumpTableBase_57C-JumpTableBase_57C
	dc.w	lbC000612-JumpTableBase_57C

JumpTableBase_57C	MOVE.B	(A1)+,($47,A0)
	ADDQ.W	#2,($36,A0)
	BRA.B	lbC000538

lbC000586	ADDQ.W	#3,($36,A0)
	MOVE.B	(A1)+,($48,A0)
	MOVE.B	(A1)+,($49,A0)
	BRA.B	lbC00054E

lbC000594	MOVEQ	#0,D0
	MOVE.B	(A1)+,D0
	MOVE.W	D0,($36,A0)
	MOVE.L	($14,A0),A1
	ADD.W	D0,A1
	BRA.B	lbC00054E

lbC0005A4	MOVEQ	#0,D1
	MOVE.B	(A1)+,D1
	CMP.B	($4C,A0),D1
	BEQ.B	lbC0005FC
	MOVE.B	D1,($4C,A0)
	MOVE.W	D0,-(SP)
	MOVE.W	($3E,A0),D0
	MOVE.W	D0,($DFF096)
	OR.W	D0,(A5)
	MOVE.W	(SP)+,D0
	MOVE.L	(lbL000BE8,PC),A4
	MOVE.W	D1,D3
	LSL.W	#3,D1
	ADD.W	D3,D3
	ADD.W	D3,D1
	ADD.W	D1,A4
	MOVE.L	(0,A0),A3
	MOVE.L	(0,A4),A2
	ADD.L	(lbL000BF0,PC),A2
	MOVE.L	A2,(A3)
	MOVE.W	(4,A4),(4,A3)
	MOVE.W	#4,(6,A3)
	MOVEQ	#0,D1
	MOVE.W	(6,A4),D1
	ADD.L	D1,A2
	MOVE.L	A2,(12,A0)
	MOVE.W	(8,A4),($34,A0)
lbC0005FC	MOVE.W	D7,($38,A0)
	MOVE.B	#1,($44,A0)
	ADDQ.W	#2,($36,A0)
	SF	($32,A0)
	BRA.W	lbC00054E

lbC000612	ST	($4C,A0)
	MOVE.W	D0,-(SP)
	MOVE.W	($3E,A0),D0
	MOVE.W	D0,($DFF096)
	OR.W	D0,(A5)
	MOVE.W	(SP)+,D0
	MOVEQ	#0,D1
	MOVE.B	(A1)+,D1
	MOVE.L	(lbL000BE8,PC),A4
	MOVE.W	D1,D3
	LSL.W	#3,D1
	ADD.W	D3,D3
	ADD.W	D3,D1
	ADD.W	D1,A4
	MOVE.L	(0,A4),A2
	ADD.L	(lbL000BF0,PC),A2
	MOVEQ	#0,D0
	MOVE.W	(4,A2),D0
	MOVE.W	(6,A2),D2
	LSL.W	#2,D2
	MULU	#$18,D0
	ADDQ.L	#8,A2
	MOVE.L	A2,A4
	ADD.L	D0,A2
	ADD.W	D2,A2
	MOVEQ	#0,D1
	MOVE.B	(A1)+,D1
	MULU	#$18,D1
	ADD.L	D1,A4
	MOVE.L	(A4)+,D1
	MOVE.L	(A4)+,D2
	AND.L	#$FFFFFFFE,D1
	AND.L	#$FFFFFFFE,D2
	SUB.L	D1,D2
	LSR.L	#1,D2
	ADD.L	A2,D1
	MOVE.L	(0,A0),A3
	MOVE.L	D1,(A3)
	MOVE.W	D2,(4,A3)
	MOVE.W	#4,(6,A3)
	MOVE.L	D1,(12,A0)
	PEA	(A2)
	MOVE.L	D1,A2
	MOVE.B	(A2)+,(A2)
	MOVE.L	(SP)+,A2
	MOVEQ	#1,D1
	MOVE.W	D1,($34,A0)
	MOVE.W	D7,($38,A0)
	MOVE.B	#1,($44,A0)
	ADDQ.W	#3,($36,A0)
	SF	($32,A0)
	BRA.W	lbC00054E

lbC0006B0	MOVE.W	D0,-(SP)
	MOVE.W	($3E,A0),D0
	MOVE.W	D0,($DFF096)
	OR.W	D0,(A5)
	MOVE.W	(SP)+,D0
	MOVE.L	(0,A0),A3
	MOVE.W	#4,(6,A3)
	MOVEQ	#0,D1
	MOVE.B	(A1)+,D1
	MOVE.L	(lbL000BE8,PC),A4
	MOVE.W	D1,D3
	LSL.W	#3,D1
	ADD.W	D3,D3
	ADD.W	D3,D1
	ADD.W	D1,A4
	MOVE.L	(0,A4),A2
	MOVE.L	A2,($1E,A0)
	MOVEQ	#0,D0
	MOVE.W	(4,A4),D0
	MOVE.W	D0,D1
	ADD.L	D0,D0
	ADD.L	D0,A2
	MOVE.L	A2,($22,A0)
	MOVE.B	(A1)+,-(SP)
	MOVE.W	(SP)+,D0
	MOVE.B	(A1)+,D0
	CMP.W	#$FFFF,D0
	BNE.B	lbC000702
	MOVE.W	D1,D0
lbC000702	MOVE.W	D0,($26,A0)
	MOVE.B	(A1)+,-(SP)
	MOVE.W	(SP)+,D0
	MOVE.B	(A1)+,D0
	MOVE.W	D0,($2A,A0)
	MOVE.B	(A1)+,-(SP)
	MOVE.W	(SP)+,D0
	MOVE.B	(A1)+,D0
	MOVE.W	D0,($28,A0)
	SF	($30,A0)
	MOVE.B	(A1)+,($31,A0)
	SF	($33,A0)
	SF	($2C,A0)
	ST	($32,A0)
	MOVE.W	D7,($38,A0)
	MOVE.B	#1,($44,A0)
	ADD.W	#9,($36,A0)
	BRA.W	lbC00054E

lbC000742	MOVE.B	(A1)+,-(SP)
	MOVE.W	(SP)+,D0
	MOVE.B	(A1)+,D0
	MOVE.W	D0,($2A,A0)
	MOVE.B	(A1)+,-(SP)
	MOVE.W	(SP)+,D0
	MOVE.B	(A1)+,D0
	MOVE.W	D0,($28,A0)
	SF	($30,A0)
	MOVE.B	(A1)+,($31,A0)
	SF	($2C,A0)
	SF	($33,A0)
	ADDQ.W	#6,($36,A0)
	BRA.W	lbC00054E

lbC00076E	ST	($4C,A0)
	MOVE.W	D0,-(SP)
	MOVE.W	($3E,A0),D0
	MOVE.W	D0,($DFF096)
	OR.W	D0,(A5)
	MOVE.W	(SP)+,D0
	MOVEQ	#0,D1
	MOVE.B	(A1)+,D1
	MOVE.L	(lbL000BE8,PC),A4
	MOVE.W	D1,D3
	LSL.W	#3,D1
	ADD.W	D3,D3
	ADD.W	D3,D1
	ADD.W	D1,A4
	MOVE.L	(0,A0),A3
	MOVE.L	(0,A4),A2
	ADD.L	(lbL000BF0,PC),A2
	MOVE.L	A2,(A3)
	MOVE.W	(4,A4),(4,A3)
	MOVE.W	#4,(6,A3)
	MOVEQ	#0,D1
	MOVE.W	(6,A4),D1
	ADD.L	D1,A2
	MOVE.L	A2,(12,A0)
	MOVE.W	(8,A4),($34,A0)
	MOVE.W	D7,($38,A0)
	MOVE.B	#1,($44,A0)
	ADDQ.W	#2,($36,A0)
	SF	($32,A0)
	BRA.W	lbC00054E

lbC0007D6	MOVEQ	#0,D1
	MOVE.B	(A1)+,D1
	MOVE.L	(lbL000BE8,PC),A4
	MOVE.W	D1,D3
	LSL.W	#3,D1
	ADD.W	D3,D3
	ADD.W	D3,D1
	ADD.W	D1,A4
	MOVE.L	(0,A0),A3
	MOVE.L	(0,A4),A2
	ADD.L	(lbL000BF0,PC),A2
	MOVE.L	A2,(A3)
	MOVEQ	#0,D1
	MOVE.W	(6,A4),D1
	ADD.L	D1,A2
	MOVE.L	A2,(12,A0)
	MOVE.W	(4,A4),(4,A3)
	MOVE.W	(8,A4),($34,A0)
	ADDQ.W	#2,($36,A0)
	SF	($32,A0)
	BRA.W	lbC00054E

lbC00081A	MOVE.B	D0,($4D,A0)
	ADDQ.W	#1,($36,A0)
lbC000822	TST.B	($32,A0)
	BEQ.W	lbC0008A6
	TST.B	($33,A0)
	BNE.W	lbC0008A6
	SUBQ.B	#1,($30,A0)
	BPL.W	lbC0008A6
	MOVE.B	($31,A0),($30,A0)
	MOVE.L	($1E,A0),A1
	MOVE.L	($22,A0),A2
	MOVEQ	#0,D0
	MOVE.W	($26,A0),D0
	MOVE.W	($28,A0),D1
	MOVE.W	($2A,A0),D2
	TST.B	($2C,A0)
	BNE.B	lbC000862
	ST	($2C,A0)
	BRA.B	lbC00088A

lbC000862	EXT.L	D1
	ADD.L	D1,D0
	BPL.B	lbC000870
	ST	($33,A0)
	SUB.L	D1,D0
	BRA.B	lbC00088A

lbC000870	MOVE.L	A1,A3
	MOVE.L	D0,D3
	ADD.L	D3,D3
	ADD.L	D3,A3
	MOVEQ	#0,D3
	MOVE.W	D2,D3
	ADD.L	D3,D3
	ADD.L	D3,A3
	CMP.L	A2,A3
	BLE.B	lbC00088A
	ST	($33,A0)
	SUB.L	D1,D0
lbC00088A	MOVE.W	D0,($26,A0)
	ADD.L	(lbL000BF0,PC),A1
	ADD.L	D0,D0
	ADD.L	D0,A1
	MOVE.W	D2,($34,A0)
	MOVE.L	A1,(12,A0)
	MOVE.L	(0,A0),A2
	MOVE.L	A1,(A2)+
	MOVE.W	D2,(A2)+
lbC0008A6	TST.B	($46,A0)
	BEQ.B	lbC0008B2
	SUBQ.B	#1,($46,A0)
	BRA.B	lbC000910

lbC0008B2	SUBQ.B	#1,($44,A0)
	BNE.B	lbC000910
	MOVE.B	($45,A0),($44,A0)
lbC0008BE	MOVE.L	($10,A0),A1
	ADD.W	($38,A0),A1
	MOVEQ	#0,D0
	MOVE.B	(A1)+,D0
	CMP.W	#$E0,D0
	BLT.B	lbC000908
	SUB.W	#$E0,D0
	ADD.W	D0,D0
	MOVE.W	(jump_table_8DE,PC,D0.W),D0
	JMP	(jump_base_8F0,PC,D0.W)

jump_table_8DE	dc.w	lbC0008FA-jump_base_8F0
	dc.w	lbC000906-jump_base_8F0
	dc.w	lbC000906-jump_base_8F0
	dc.w	lbC000906-jump_base_8F0
	dc.w	lbC000906-jump_base_8F0
	dc.w	lbC000906-jump_base_8F0
	dc.w	lbC000906-jump_base_8F0
	dc.w	lbC000906-jump_base_8F0
	dc.w	jump_base_8F0-jump_base_8F0

jump_base_8F0	MOVE.B	(A1),($46,A0)
	ADDQ.W	#2,($38,A0)
	BRA.B	lbC0008A6

lbC0008FA	MOVEQ	#0,D0
	MOVE.B	(A1),D0
	SUBQ.W	#5,D0
	MOVE.W	D0,($38,A0)
	BRA.B	lbC0008BE

lbC000906	BRA.B	lbC000910

lbC000908	MOVE.B	D0,($4F,A0)
	ADDQ.W	#1,($38,A0)
lbC000910	MOVE.B	($4D,A0),D0
	BMI.B	lbC00091E
	ADD.B	($41,A0),D0
	ADD.B	($4E,A0),D0
lbC00091E	AND.W	#$7F,D0
	LEA	(lbW000C04,PC),A1
	ADD.W	D0,D0
	MOVE.W	(A1,D0.W),D0
	MOVEQ	#10,D2
	TST.B	($4A,A0)
	BEQ.B	lbC00093A
	SUBQ.B	#1,($4A,A0)
	BRA.B	lbC000982

lbC00093A	MOVEQ	#0,D1
	MOVEQ	#0,D4
	MOVEQ	#0,D5
	MOVE.B	($50,A0),D6
	MOVE.B	($49,A0),D4
	MOVE.B	($48,A0),D5
	MOVE.B	($40,A0),D1
	BTST	#5,D6
	BNE.B	lbC000962
	SUB.W	D5,D1
	BPL.B	lbC00096E
	BSET	#5,D6
	MOVEQ	#0,D1
	BRA.B	lbC00096E

lbC000962	ADD.W	D5,D1
	CMP.W	D4,D1
	BLE.B	lbC00096E
	BCLR	#5,D6
	MOVE.W	D4,D1
lbC00096E	MOVE.B	D1,($40,A0)
	MOVE.B	D6,($50,A0)
	LSR.W	#1,D4
	SUB.W	D4,D1
	EXT.L	D1
	MULS	D0,D1
	ASR.L	D2,D1
	ADD.L	D1,D0
lbC000982	BTST	#5,($42,A0)
	BEQ.B	lbC0009B2
	MOVEQ	#0,D1
	MOVE.B	($4B,A0),D1
	BMI.B	lbC0009A2
	ADD.W	D1,($1C,A0)
	MOVE.W	($1C,A0),D1
	MULU	D0,D1
	LSR.L	D2,D1
	SUB.W	D1,D0
	BRA.B	lbC0009B2

lbC0009A2	NEG.B	D1
	ADD.W	D1,($1C,A0)
	MOVE.W	($1C,A0),D1
	MULU	D0,D1
	LSR.L	D2,D1
	ADD.W	D1,D0
lbC0009B2	MOVE.W	D0,($2E,A0)
	TST.B	($52,A0)
	BEQ.B	lbC0009CC
	MOVE.L	(0,A0),A3
	MOVE.W	#1,(6,A3)
	MOVE.W	#0,(10,A3)
lbC0009CC	SWAP	D0
	MOVEQ	#0,D1
	MOVEQ	#0,D2
	MOVE.B	($4F,A0),D2
	LEA	(lbL000B68,PC),A1
	CMP.L	A0,A1
	BEQ.B	lbC0009F0
	MOVE.B	($51,A0),D1
	SUB.W	(lbW000C00,PC),D1
	BPL.B	lbC0009EA
	MOVEQ	#0,D1
lbC0009EA	MULU	D1,D2
	DIVU	#$64,D2
lbC0009F0	MOVE.W	D2,D0
	RTS

lbW0009F4	dc.w	$100
	dcb.w	2,0
	dc.w	$E1
	dcb.w	8,0
ZeroSample_A0C	dcb.w	3,0
lbW000A12	dcb.w	2,0
hipc_pauseboolean	dc.w	0
hipc_chanstruct_A18	dcb.l	3,0
lbL000A24	dcb.l	10,0
lbW000A4C	dcb.w	$10,0
lbL000A6C	dcb.l	3,0
lbL000A78	dcb.l	10,0
lbW000AA0	dcb.w	$10,0
lbL000AC0	dcb.l	3,0
lbL000ACC	dcb.l	10,0
lbW000AF4	dcb.w	$10,0
lbL000B14	dcb.l	3,0
lbL000B20	dcb.l	10,0
lbW000B48	dcb.w	$10,0
lbL000B68	dcb.l	3,0
lbL000B74	dcb.l	10,0
lbW000B9C	dcb.w	$10,0
hipc_chanoffsets	dc.w	$A0	;aud0 hw offset
	dc.w	0
	dc.w	$B0	;aud1 hw offset
	dc.w	3
	dc.w	$C0
	dc.w	6
	dc.w	$D0
	dc.w	9
	dc.w	$40
lbW000BCE	dc.w	0
lbL000BD0	dc.l	0
lbL000BD4	dc.l	0
lbL000BD8	dc.l	0
lbL000BDC	dc.l	0
lbL000BE0	dc.l	0
lbL000BE4	dc.l	0
lbL000BE8	dc.l	0
lbL000BEC	dc.l	0
lbL000BF0	dc.l	0
lbL000BF4	dc.l	0
hipc_subsongtabptr	dc.l	0
hipc_modptr	dc.l	0
lbW000C00	dc.w	0
lbW000C02	dc.w	0
lbW000C04	dc.w	$6B0
	dc.w	$650
	dc.w	$5F4
	dc.w	$5A0
	dc.w	$54C
	dc.w	$500
	dc.w	$4B8
	dc.w	$474
	dc.w	$434
	dc.w	$3F8
	dc.w	$3C0
	dc.w	$38A
	dc.w	$358
	dc.w	$328
	dc.w	$2FA
	dc.w	$2D0
	dc.w	$2A6
	dc.w	$280
	dc.w	$25C
	dc.w	$23A
	dc.w	$21A
	dc.w	$1FC
	dc.w	$1E0
	dc.w	$1C5
	dc.w	$1AC
	dc.w	$194
	dc.w	$17D
	dc.w	$168
	dc.w	$153
	dc.w	$140
	dc.w	$12E
	dc.w	$11D
	dc.w	$10D
	dc.w	$FE
	dc.w	$F0
	dc.w	$E2
	dc.w	$D6
	dc.w	$CA
	dc.w	$BE
	dc.w	$B4
	dc.w	$AA
	dc.w	$A0
	dc.w	$97
	dc.w	$8F
	dc.w	$87
	dc.w	$7F
	dc.w	$78
	dcb.w	13,$71
	dc.w	$D60
	dc.w	$CA0
	dc.w	$BE8
	dc.w	$B40
	dc.w	$A98
	dc.w	$A00
	dc.w	$970
	dc.w	$8E8
	dc.w	$868
	dc.w	$7F0
	dc.w	$780
	dc.w	$714

	end
